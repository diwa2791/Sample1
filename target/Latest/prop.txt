<div class="pagination">

<a th:if="${data.page > 0}"
   th:href="@{/compare/result(cacheId=${cacheId},tab=${tab},page=${data.page-1})}">
   ◀ Prev
</a>

<span class="page-info">
 Page <b th:text="${data.page+1}"></b>
 /
 <span th:text="${data.totalPages}"></span>
</span>

<a th:if="${data.page+1 < data.totalPages}"
   th:href="@{/compare/result(cacheId=${cacheId},tab=${tab},page=${data.page+1})}">
   Next ▶
</a>

</div>

.pagination{
    display:flex;
    justify-content:center;
    gap:20px;
    margin-top:20px;
}

.pagination a{
    padding:8px 16px;
    border-radius:8px;
    background:rgba(255,255,255,0.15);
    backdrop-filter:blur(8px);
    text-decoration:none;
    color:white;
    font-weight:600;
}

.pagination a:hover{
    background:rgba(255,255,255,0.3);
}

.page-info{
    color:#fff;
    font-size:16px;
}


================================
<div class="export-wrapper">

<button class="export-btn" onclick="toggleExportMenu()">
    Export ▼
</button>

<div id="exportMenu" class="export-menu">
    <a th:href="@{/compare/export(cacheId=${cacheId},type='ALL')}">All</a>
    <a th:href="@{/compare/export(cacheId=${cacheId},type='MODIFIED')}">Modified</a>
    <a th:href="@{/compare/export(cacheId=${cacheId},type='ONLY_TEST')}">Only Test</a>
    <a th:href="@{/compare/export(cacheId=${cacheId},type='ONLY_PROD')}">Only Prod</a>
</div>

</div>





.export-wrapper{
    position:relative;
    display:inline-block;
}

.export-btn{
    padding:10px 18px;
    border-radius:10px;
    background:rgba(255,255,255,0.2);
    backdrop-filter:blur(10px);
    border:none;
    color:white;
    cursor:pointer;
}

.export-menu{
    display:none;
    position:absolute;
    top:45px;
    right:0;
    background:rgba(30,40,50,0.95);
    border-radius:10px;
    overflow:hidden;
    min-width:160px;
}

.export-menu a{
    display:block;
    padding:10px;
    color:white;
    text-decoration:none;
}

.export-menu a:hover{
    background:rgba(255,255,255,0.2);
}
=================================



<script>
function toggleExportMenu(){
    const m=document.getElementById("exportMenu");
    m.style.display = m.style.display==="block"?"none":"block";
}
</script>


====================================
@GetMapping("/row")
@ResponseBody
public RowDiffDTO getRow(
        @RequestParam String cacheId,
        @RequestParam String pk,
        @RequestParam String tab) {

    return service.getRowDetails(cacheId, pk, tab);
}

========================================

public RowDiffDTO getRowDetails(
        String cacheId,
        String pk,
        String tab){

    TableDiffResponseDTO diff = cache.get(cacheId);

    List<RowDiffDTO> list =
            switch(tab){
                case "test" -> diff.getOnlyInTestRows();
                case "prod" -> diff.getOnlyInProdRows();
                default -> diff.getModifiedRows();
            };

    return list.stream()
            .filter(r -> r.getPrimaryKey().equals(pk))
            .findFirst()
            .orElse(null);
}

==============================================

<button
  class="expand-btn"
  th:attr="data-pk=${row.primaryKey}"
  onclick="loadRow(this)">
  Expand
</button>

=============================================

<tr class="expand-row" style="display:none;">
   <td colspan="3">
       <div class="expand-content"></div>
   </td>
</tr>

============================================

<script>

async function loadRow(btn){

    const tr = btn.closest("tr");
    const expandRow = tr.nextElementSibling;
    const container = expandRow.querySelector(".expand-content");

    if(expandRow.style.display==="table-row"){
        expandRow.style.display="none";
        return;
    }

    container.innerHTML =
        "<div class='spinner'></div>";

    expandRow.style.display="table-row";

    const pk = btn.dataset.pk;

    const url =
      `/compare/row?cacheId=${cacheId}&pk=${encodeURIComponent(pk)}&tab=${tab}`;

    const res = await fetch(url);
    const data = await res.json();

    container.innerHTML = buildExpandHtml(data);
}

function buildExpandHtml(row){

    let html =
        `<table class="inner-table">
            <tr>
                <th>Column</th>
                <th>Test</th>
                <th>Prod</th>
            </tr>`;

    row.changedColumns.forEach(c=>{
        html+=`
        <tr>
          <td>${c.columnName}</td>
          <td>${c.testHighlighted}</td>
          <td class="prod-value">${c.prodHighlighted}</td>
        </tr>`;
    });

    html+=`</table>`;
    return html;
}

</script>


========================================================

.spinner{
    width:28px;
    height:28px;
    border:4px solid rgba(255,255,255,.2);
    border-top:4px solid white;
    border-radius:50%;
    animation:spin 1s linear infinite;
    margin:auto;
}

@keyframes spin{
    100%{transform:rotate(360deg);}
}
