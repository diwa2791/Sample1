<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>

<link rel="stylesheet"
 href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

</head>

<body style="background:#0f2027;color:white;
display:flex;align-items:center;justify-content:center;height:100vh;">

<div style="width:400px">

<h4>Comparing Tables...</h4>

<div class="progress mt-3">
<div id="bar"
 class="progress-bar progress-bar-striped progress-bar-animated"
 style="width:0%">0%</div>
</div>

</div>

<script th:inline="javascript">

const jobId = [[${jobId}]];

function poll(){

fetch("/compare/progress/"+jobId)
.then(r=>r.json())
.then(data=>{

let bar=document.getElementById("bar");

bar.style.width=data.progress+"%";
bar.innerText=data.progress+"%";

if(data.status==="DONE"){
 window.location="/compare/result?cacheId="+data.cacheId;
}else{
 setTimeout(poll,1000);
}
});
}

poll();

</script>

</body>
</html>
