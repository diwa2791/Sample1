<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>

<link rel="stylesheet"
 href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

<style>
body{
background:linear-gradient(135deg,#0f2027,#2c5364,#00c9a7);
color:white;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
}
.glass{
background:rgba(255,255,255,.08);
backdrop-filter:blur(12px);
padding:40px;
border-radius:12px;
width:400px;
}
</style>

</head>

<body>

<div class="glass text-center">

<h4>Comparing Tables...</h4>

<div class="progress mt-4">
<div id="bar"
 class="progress-bar progress-bar-striped progress-bar-animated"
 style="width:0%">0%</div>
</div>

</div>

<script th:inline="javascript">

const jobId = [[${jobId}]];

function poll(){

fetch("/compare/progress/"+jobId)
.then(r=>r.json())
.then(data=>{

let bar=document.getElementById("bar");

bar.style.width=data.progress+"%";
bar.innerText=data.progress+"%";

if(data.status==="DONE"){
 window.location="/compare/view?cacheId="+data.cacheId;
}
else{
 setTimeout(poll,1000);
}
});
}

poll();

</script>

</body>
</html>
